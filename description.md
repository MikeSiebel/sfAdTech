# SF-AdTech - сайт площадки интернет-рекламы
**Документация**

## Назначение

Эта система предназначена для размещения и учета интернет-рекламы. Она позволяет создавать рекламные кампании, контролировать их настройки, отслеживать статистику и рассчитывать затраты.

## Пользователи системы 

В системе предусмотрены три роли пользователей:

- Рекламодатель;
- Веб-мастер;
- Администратор.

Ползователь с ролью "Рекламодатель" может:

- добавлять/изменять/деактивировать рекламные предложения (офферы);
- просматривать сведения о подписках на офферы;
- анализировать отчеты: "Статистика переходов", "Затраты на рекламу"

Ползователь с ролью "Веб-мастер" может:

- просматривать список доступных предложений
- подписываться на рекламные предложения (офферы);
- просматривать записи о пререходах клиентов по подписанным офферам;
- просматривать отчеты: "Статистика переходов", "Доходы от подписки"

Ползователь с ролью "Администратор" может:

- редактировать профили остальных пользователей, в том числе назначать роли и уровень доступа (нет доступа/просмотр/изменение);
- просматривать данные о выставленных офферах и оформленных подписках;
- просматривать отчеты: "Статистика переходов", "Доходы рекламной площадки"

Роли пользователям могут предоставляться следующим образом:

- любой зарегистрированный и авторизованный пользователь может назначить себе роль "Рекламодатель" и/или "Веб-мастер" на странице редактирования своего профиля (пункт меню "Профиль");
- Администратор системы может назначать зарегистрированным пользователям любую роль, в том числе роль "Администратор", зайдя в профиль пользователя через пункт меню "Пользователи" и выбрав пользователя в списке.

## Интерфейс системы

Навигация по сайту осуществляется с помощью меню в заголовке страницы. 
Для рекламодателя основной пункт меню - "Варианты предложений", для Веб-мастера - пункт "Подписки". Описание функций данных пунктов будет дано ниже. Для всех ролей доступны пункты меню "Аналитическая информация", "Клиентская база", "Профиль", "Регистрация", "Вход" и "Выход". Пункт "Пользователи" предназначен для администратора сайта. 

**Пункт меню "Варианты предложений"**

При выборе данного пункта меню пользователь попадает на страницу, где отображается список предложений по рекламе (офферов) и их статус (Доступен/Недоступен). Пользователи с ролью "Рекламодатель" увидят только свои офферы в любом статусе (активен/неактивен). Пользователи с ролью "Веб-мастер" увидят список всех активных офферов в системе.
На этой странице Рекламодателю доступны следующие функции:

- добавление нового предложения;
- просмотр и изменение своих оффероов, в т.ч. цену за один переход, рекламную ссылку, тему, статус "Доступен/Недоступен";
- просмотр подписок на предложение.

Веб-мастер на данной странице может просмотреть список доступных офферов и выбрать те, на которые он хочет оформить подписку (кнопка "Подписаться" на странице просмотра оффера).

**Пункт меню "Подписки"**

Данный пункт меню предназначен для Веб-мастеров. Он открывает страницу со списком подписок текущего пользователя на рекламные предложения. Веб-мастер может выполнять следующие действия для каждой подписки:

- посмотреть параметры подписки;
- удалить подписку;
- скопировать ссылку на целевой ресурс для встраивания ее на свой ресурс (при клике на ссылку, она будет скопирована в буфер обмена).

Кроме того, со страницы списка подписок можно перейти на страницу для тестирования рекламных ссылок через API-интерфейс.

**Пункт меню "Аналитическая информация"**

Данный пункт ведёт на страницу со сылками на доступные отчеты. В системе можно сформировать следующие отчеты:

1. Отчет о статистике переходов по целевым ссылкам из офферов рекламодателей, включающий количество запросов ссылок, успешно проверенные запросы и подтвержденные переходы;
2. Отчет о затратах рекламодателя на основе подтвержденных переходов по ссылкам;
3. Отчет о доходе Веб-мастера от подписок на офферы;
4. Отчет о доходе системы.

Во всех отчетах можно указать период, для которого нужен отчет, тип агрегации сумм (день, месяц, год) и уровень группировки (период, рекламодатель, оффер). Кроме табличных данных, для отчетов 2, 3 и 4 система также отображает график динамики сумм.

**Пункт меню "Клиентская база"**

Данный раздел предназначен для Администратора и открывает страницу со списком пользователей. Администратор может выбрать пользователя из списка и открыть его профиль.

**Пункт меню "Профиль"**

Данный раздел открывает страницу профиля пользователя. На этой странице пользователь имеет возможность вносить изменения в информацию о себе, изменять пароль и назначать себе роли "Рекламодатель" или "Веб-мастер". Администратор системы также может назначать роль "Администратор" и изменять уровень доступа пользователя. Кроме того, на данной странице пользователь может получить токен для доступа к сайту через API-интерфейс (см. далее).

## Использование API интерфейса системы для интеграции ссылок перехода на целевые рекламные адреса на сайтах веб-мастеров

Алгоритм использования ссылок на целевые рекламные ресурсы с веб-сайта веб-мастера следующий:

Веб-мастер внедряет ссылку на целевой рекламный ресурс на своем сайте, указывая ID подписки на оффер рекламодателя. При отправке GET-запроса требуется авторизация с использованием токена.
Когда система получает запрос от веб-мастера, она авторизуется и записывает переход в биллинговой системе, а также проверяет валидность и доступность подписки по ID.
Если подписка недоступна, система перенаправляет запрос на страницу с сообщением об ошибке.
Если проверка проходит успешно, система возвращает ссылку на целевой рекламный ресурс. К ссылке добавляется параметр (?rd=<9999>), содержащий ID записи о переходе в биллинговой системе.
Веб-мастер открывает новую страницу с целевым рекламным адресом для пользователя своего сайта.
На целевой странице рекламодатель, используя JavaScript и авторизацию по токену, отправляет запрос через API системы для подтверждения перехода с указанным ID.
Для реализации этого алгоритма API системы предоставляет два простых маршрута:

/api/go/{id} - запрос целевого адреса для веб-мастера, где ID - это подписка веб-мастера на оффер рекламодателя. Веб-мастер может получить эту ссылку на странице просмотра подписки. Пример скрипта запроса приведен в коде файла test.blade.php.

/api/success/{id} - подтверждение перехода на страницу рекламодателя с указанным ID, который рекламодатель получает из параметра (?rd=<9999>) GET-запроса на своем сайте. Пример скрипта запроса приведен в коде файла redir-index.blade.php.

***
**2023@MikeSiebel** [sfadtech project - SF-AdTech](https://github.com/MikeSiebel/sfadtech.git)